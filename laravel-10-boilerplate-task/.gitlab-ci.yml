stages:
  - test
  - build
  - deploy

workflow:
  rules:
    - when: always

####################################
# TEST
####################################
test:
  stage: test
  script:
    - echo "Running tests"
    - docker version
    - docker compose version || true
  rules:
    - when: on_success

####################################
# BUILD
####################################
build:
  stage: build
  needs: ["test"]
  script:
    - echo "Building image"
    - docker build -t test-image .
  rules:
    - when: on_success

####################################
# DEPLOY
####################################
deploy:
  stage: deploy
  needs: ["build"]
  script:
    - echo "Deploy step placeholder"
  rules:
    - when: on_success
